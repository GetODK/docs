test:
  pre:
    # your fork of the docs repo is probably not called "docs"
    # so, if there is no "docs" folder, find the repo folder and rename it to docs
    - if [ ! -d $HOME/docs ]; then mv `dirname $HOME/*/circle.yml` $HOME/docs; fi

  override:
    - sphinx-build $HOME/docs $HOME/docs/build

  post:
    - cp -r $HOME/docs/build $CIRCLE_ARTIFACTS

deployment:
  production:
    branch: master
    owner: opendatakit-bot
    commands:
      - aws s3 sync $HOME/docs/build s3://docs.opendatakit.org --delete --exclude .buildinfo --exclude .doctrees --exclude objects.inv
